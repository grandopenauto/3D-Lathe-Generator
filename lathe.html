<!doctype html>
<html lang="en">
	<head>
		<title>3D Lathe Tool</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		
		<link rel="stylesheet" href="assets/css/main.css" />
		<link rel="stylesheet" href="assets/css/lathe-tool.css" />
	</head>
	<body>
		<div class="project-info">
			Pawn generated using THREE.js LatheGeometry. <br />
			Drag left/right &amp; up/down to inspect 
			<a class="save-stl" href="#">Click to save STL</a> 
		</div>

		<div class="module module-lathe-tool" data-name="lathe-tool">
			<!-- Container for module -->
		</div>

		<script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
		<script src="assets/js/libs/FileSaver.js"></script>
    	<script src="assets/js/libs/stlWriter.js"></script>
		<script src="assets/js/libs/Three.js"></script>
		<script src="assets/js/modules/Lathe.js"></script>
		<script>
			$(function() {
				var lathe = new Lathe({
					instance: $(".module-lathe-tool").eq(0)
				});

				$(".save-stl").click(function(e) {
					e.preventDefault();
					lathe.save();
				});

				function createPawnShape() {
					var shape = new THREE.Shape(),
						shapePoints = [],
						adjustedPoints = [];

					shape.moveTo( 0, 100 );
					shape.arc(0, 0, 25, 1.57079633, 4.71238898, false);
					shape.moveTo( 0, 85 );
					shape.lineTo( -35, 70 );
					shape.lineTo( -15, 60 );
					shape.lineTo( -15, 0 );
					shape.quadraticCurveTo( -30, -10, -10, -10);
					shape.quadraticCurveTo( -40, 0, -40, -20);
					shape.quadraticCurveTo( -50, -20, -45, -30);

					shape.lineTo( 0, -30 );
					shape.moveTo( 0, -30 );

					shapePoints = shape.extractPoints().shape;

					// TODO: create helper to rotate axis of points
					for( var i = 0; i < shapePoints.length; i++ ) {
						adjustedPoints.push( new THREE.Vector3(shapePoints[i].x, 0, shapePoints[i].y) );
					}

					return adjustedPoints;
				}

				var shapePoints = createPawnShape();
				lathe.addShape(shapePoints);
			});
		</script>
	</body>
</html>
